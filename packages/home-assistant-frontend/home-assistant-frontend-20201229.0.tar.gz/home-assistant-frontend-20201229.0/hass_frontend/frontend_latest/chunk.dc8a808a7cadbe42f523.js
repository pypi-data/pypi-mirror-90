(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([[5005],{77760:(e,t,i)=>{"use strict";i.d(t,{VG:()=>g,UO:()=>O});var s=i(4915),n=i(58831),r=i(27269),o=i(22311),a=i(91741),c=i(49706);var d=i(85415);const h=async(e,t)=>new Promise((i=>{const s=t(e,(e=>{s(),i(e)}))}));var l=i(57066),u=i(57292),p=i(74186),f=i(5986),m=i(41499),v=i(14748);const y=["binary_sensor","mailbox","person","sensor","sun","timer"],w=new Set(["automation","configurator","device_tracker","geo_location","persistent_notification","zone"]),b=new Set(["mobile_app"]);let _=!1;const g=(e,t,i=!1)=>{const s=[],r=[],o=t.title?t.title+" ":void 0;for(const[t,c]of e){const e=(0,n.M)(t);if("alarm_control_panel"===e){const e={type:"alarm-panel",entity:t};s.push(e)}else if("camera"===e){const e={type:"picture-entity",entity:t};s.push(e)}else if("climate"===e){const e={type:"thermostat",entity:t};s.push(e)}else if("humidifier"===e){const e={type:"humidifier",entity:t};s.push(e)}else if("light"===e&&i){const e={type:"light",entity:t};s.push(e)}else if("media_player"===e){const e={type:"media-control",entity:t};s.push(e)}else if("plant"===e){const e={type:"plant-status",entity:t};s.push(e)}else if("weather"===e){const e={type:"weather-forecast",entity:t,show_forecast:!1};s.push(e)}else if("sensor"===e&&(null==c?void 0:c.attributes.device_class)===m.A);else{let e;const i=o&&c&&(e=(0,a.C)(c)).startsWith(o)?{entity:t,name:e.substr(o.length)}:t;r.push(i)}}return r.length>0&&s.unshift({type:"entities",entities:r,...t}),s},E=(e,t,i,s,r,c)=>{const h=(e=>{const t=[],i={};return Object.keys(e).forEach((s=>{const r=e[s];"group"===(0,n.M)(s)?t.push(r):i[s]=r})),t.forEach((e=>e.attributes.entity_id.forEach((e=>{delete i[e]})))),{groups:t,ungrouped:i}})(r);h.groups.sort(((e,t)=>c[e.entity_id]-c[t.entity_id]));const l={},u={};Object.keys(h.ungrouped).forEach((e=>{const t=h.ungrouped[e],i=(0,o.N)(t),s=y.includes(i)?l:u;i in s||(s[i]=[]),s[i].push(t.entity_id)}));let p=[];y.forEach((e=>{e in l&&(p=p.concat(l[e]))}));let m=[];h.groups.forEach((e=>{m=m.concat(g(e.attributes.entity_id.map((e=>[e,r[e]])),{title:(0,a.C)(e),show_header_toggle:"hidden"!==e.attributes.control}))})),Object.keys(u).sort().forEach((t=>{m=m.concat(g(u[t].sort(((e,t)=>(0,d.q)((0,a.C)(r[e]),(0,a.C)(r[t])))).map((e=>[e,r[e]])),{title:(0,f.Lh)(e,t)}))}));const w={path:t,title:i,badges:(0,v.Q)(p),cards:m};return s&&(w.icon=s),w},k=(e,t,i,s,n)=>{const r=((e,t)=>{const i={},s=new Set(t.filter((e=>b.has(e.platform))).map((e=>e.entity_id)));return Object.keys(e).forEach((t=>{const n=e[t];w.has((0,o.N)(n))||s.has(n.entity_id)||(i[t]=e[t])})),i})(s,i),a={};Object.keys(r).forEach((e=>{const t=r[e];t.attributes.order&&(a[e]=t.attributes.order)}));const c=((e,t,i,s)=>{const n={...s},r=[];for(const s of e){const e=[],o=new Set(t.filter((e=>e.area_id===s.area_id)).map((e=>e.id)));for(const t of i)o.has(t.device_id)&&t.entity_id in n&&(e.push(n[t.entity_id]),delete n[t.entity_id]);e.length>0&&r.push([s,e])}return{areasWithEntities:r,otherEntities:n}})(e,t,i,r),d=E(n,"default_view","Home",undefined,c.otherEntities,a),h=[];return c.areasWithEntities.forEach((([e,t])=>{h.push(...g(t.map((e=>[e.entity_id,e])),{title:e.name}))})),d.cards.unshift(...h),d},P=async(e,t,i,s,o,d)=>{if(e.safe_mode)return{title:e.location_name,views:[{cards:[{type:"safe-mode"}]}]};const h=(e=>{const t=[];return Object.keys(e).forEach((i=>{const s=e[i];s.attributes.view&&t.push(s)})),t.sort(((e,t)=>e.entity_id===c.a1?-1:t.entity_id===c.a1?1:e.attributes.order-t.attributes.order)),t})(o),l=h.map((e=>{const t=((e,t)=>{const i={};return t.attributes.entity_id.forEach((t=>{const s=e[t];if(s&&(i[s.entity_id]=s,"group"===(0,n.M)(s.entity_id))){const t=((e,t)=>{const i={};return t.attributes.entity_id.forEach((t=>{const s=e[t];s&&(i[s.entity_id]=s)})),i})(e,s);Object.keys(t).forEach((e=>{const s=t[e];i[e]=s}))}})),i})(o,e),i={};return Object.keys(t).forEach(((e,t)=>{i[e]=t})),E(d,(0,r.p)(e.entity_id),(0,a.C)(e),e.attributes.icon,t,i)}));let u=e.location_name;return 0!==h.length&&"group.default_view"===h[0].entity_id||(l.unshift(k(t,i,s,o,d)),e.components.includes("geo_location")&&l[0]&&l[0].cards&&l[0].cards.push({type:"map",geo_location_sources:["all"]}),l.length>1&&"Home"===u&&(u="Home Assistant")),1===l.length&&0===l[0].cards.length&&l[0].cards.push({type:"empty-state"}),{title:u,views:l}},O=async(e,t)=>{if(e.config.state===s.UE)return{title:e.config.location_name,views:[{cards:[{type:"starting"}]}]};if(e.config.safe_mode)return{title:e.config.location_name,views:[{cards:[{type:"safe-mode"}]}]};_||(_=!0,(0,l.sG)(e.connection,(()=>{})),(0,u.q4)(e.connection,(()=>{})),(0,p.LM)(e.connection,(()=>{})));const[i,n,r]=await Promise.all([h(e.connection,l.sG),h(e.connection,u.q4),h(e.connection,p.LM)]);return P(e.config,i,n,r,e.states,t||e.localize)}},51153:(e,t,i)=>{"use strict";i.d(t,{l$:()=>o,Z6:()=>a,Do:()=>c});i(10175),i(80251),i(99471),i(14888),i(69377),i(95035),i(38026),i(89173),i(41043),i(57464),i(24617),i(26136),i(82778);var s=i(7778);const n=new Set(["entity","entities","button","entity-button","glance","history-graph","horizontal-stack","light","sensor","thermostat","vertical-stack","weather-forecast"]),r={"alarm-panel":()=>i.e(1878).then(i.bind(i,81878)),error:()=>Promise.all([i.e(9033),i.e(947),i.e(8394)]).then(i.bind(i,55796)),"empty-state":()=>i.e(7284).then(i.bind(i,67284)),grid:()=>i.e(6169).then(i.bind(i,6169)),starting:()=>i.e(7873).then(i.bind(i,47873)),"entity-filter":()=>i.e(3688).then(i.bind(i,33688)),humidifier:()=>i.e(8558).then(i.bind(i,68558)),"media-control":()=>Promise.all([i.e(1935),i.e(3525)]).then(i.bind(i,13525)),"picture-elements":()=>Promise.all([i.e(4909),i.e(319),i.e(7282),i.e(9810),i.e(1441)]).then(i.bind(i,83358)),"picture-entity":()=>Promise.all([i.e(319),i.e(7282),i.e(8317)]).then(i.bind(i,41500)),"picture-glance":()=>Promise.all([i.e(319),i.e(7282),i.e(7987)]).then(i.bind(i,66621)),"plant-status":()=>i.e(8723).then(i.bind(i,48723)),"safe-mode":()=>i.e(6983).then(i.bind(i,24503)),"shopping-list":()=>Promise.all([i.e(7440),i.e(3376)]).then(i.bind(i,43376)),conditional:()=>i.e(8857).then(i.bind(i,68857)),gauge:()=>i.e(5223).then(i.bind(i,25223)),iframe:()=>i.e(5018).then(i.bind(i,95018)),map:()=>i.e(76).then(i.bind(i,60076)),markdown:()=>Promise.all([i.e(4940),i.e(6474)]).then(i.bind(i,51282)),picture:()=>i.e(5338).then(i.bind(i,45338)),calendar:()=>Promise.resolve().then(i.bind(i,80251)),logbook:()=>Promise.all([i.e(9160),i.e(6576),i.e(851)]).then(i.bind(i,8436))},o=e=>(0,s.Xm)("card",e,n,r,void 0,void 0),a=e=>(0,s.Tw)("card",e,n,r,void 0,void 0),c=e=>(0,s.ED)(e,"card",n,r)},89026:(e,t,i)=>{"use strict";i.d(t,{t:()=>r,Q:()=>o});var s=i(7778);const n={picture:()=>i.e(9130).then(i.bind(i,69130)),buttons:()=>i.e(2587).then(i.bind(i,32587)),graph:()=>i.e(5773).then(i.bind(i,25773))},r=e=>(0,s.Tw)("header-footer",e,void 0,n,void 0,void 0),o=e=>(0,s.ED)(e,"header-footer",void 0,n)},97504:(e,t,i)=>{"use strict";i.d(t,{L:()=>n,F:()=>r});var s=i(47181);const n=()=>Promise.all([i.e(1458),i.e(9160),i.e(3330),i.e(6619),i.e(1480),i.e(5796),i.e(9779),i.e(2979),i.e(1687)]).then(i.bind(i,52408)),r=(e,t)=>{(0,s.B)(e,"show-dialog",{dialogTag:"hui-dialog-create-card",dialogImport:n,dialogParams:t})}},54324:(e,t,i)=>{"use strict";i.d(t,{Z0:()=>s,BN:()=>n,LG:()=>r,f1:()=>o,qD:()=>a,Y7:()=>c,wI:()=>d,Uo:()=>h,YI:()=>l,mA:()=>u,PT:()=>p});const s=(e,t,i)=>{const[s]=t,n=[];return e.views.forEach(((t,r)=>{if(r!==s)return void n.push(e.views[r]);const o=t.cards?[...t.cards,i]:[i];n.push({...t,cards:o})})),{...e,views:n}},n=(e,t,i)=>{const[s]=t,n=[];return e.views.forEach(((t,r)=>{if(r!==s)return void n.push(e.views[r]);const o=t.cards?[...t.cards,...i]:[...i];n.push({...t,cards:o})})),{...e,views:n}},r=(e,t,i)=>{const[s,n]=t,r=[];return e.views.forEach(((t,o)=>{o===s?r.push({...t,cards:(t.cards||[]).map(((e,t)=>t===n?i:e))}):r.push(e.views[o])})),{...e,views:r}},o=(e,t)=>{const[i,s]=t,n=[];return e.views.forEach(((t,r)=>{r===i?n.push({...t,cards:(t.cards||[]).filter(((e,t)=>t!==s))}):n.push(e.views[r])})),{...e,views:n}},a=(e,t,i)=>{const[s,n]=t,r=[];return e.views.forEach(((t,o)=>{if(o!==s)return void r.push(e.views[o]);const a=t.cards?[...t.cards.slice(0,n),i,...t.cards.slice(n)]:[i];r.push({...t,cards:a})})),{...e,views:r}},c=(e,t,i)=>{const s=e.views[t[0]].cards[t[1]],n=e.views[i[0]].cards[i[1]],r=e.views[t[0]],o={...r,cards:r.cards.map(((e,i)=>i===t[1]?n:e))},a=t[0]===i[0]?o:e.views[i[0]],c={...a,cards:a.cards.map(((e,t)=>t===i[1]?s:e))};return{...e,views:e.views.map(((e,s)=>s===i[0]?c:s===t[0]?o:e))}},d=(e,t,i)=>{if(t[0]===i[0])throw new Error("You can not move a card to the view it is in.");const s=e.views[t[0]],n=s.cards[t[1]],r={...s,cards:(s.cards||[]).filter(((e,i)=>i!==t[1]))},o=e.views[i[0]],a=o.cards?[...o.cards,n]:[n],c={...o,cards:a};return{...e,views:e.views.map(((e,s)=>s===i[0]?c:s===t[0]?r:e))}},h=(e,t)=>({...e,views:e.views.concat(t)}),l=(e,t,i)=>({...e,views:e.views.map(((e,s)=>s===t?i:e))}),u=(e,t,i)=>{const s=e.views[t],n=e.views[i];return{...e,views:e.views.map(((e,r)=>r===i?s:r===t?n:e))}},p=(e,t)=>({...e,views:e.views.filter(((e,i)=>i!==t))})},14748:(e,t,i)=>{"use strict";function s(e){return e.map((e=>"string"==typeof e?{entity:e}:e))}i.d(t,{Q:()=>s})}}]);
//# sourceMappingURL=chunk.dc8a808a7cadbe42f523.js.map