image: python:3.8-slim

pages:
  script:
  - pip install --exists-action=w --no-cache-dir -r docs/requirements.txt
  - apt-get update && apt-get install -y --no-install-recommends git build-essential pandoc
  - python ./setup.py install --force
  - cd docs
  - make html
  - mv _build/html ../public
  artifacts:
    paths:
    - public
  only:
  - tags

pages-test:
  script:
  - pip install --exists-action=w --no-cache-dir -r docs/requirements.txt
  - apt-get update && apt-get install -y --no-install-recommends git build-essential pandoc
  - python ./setup.py install --force
  - cd docs
  - make html
  only:
  - tags
  except:
  - master
