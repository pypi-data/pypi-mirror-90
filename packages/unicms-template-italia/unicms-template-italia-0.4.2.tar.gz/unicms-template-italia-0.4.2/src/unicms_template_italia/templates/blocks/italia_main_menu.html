{% load i18n %}
{% load static %}


{% load unicms_template_italia %}


<div class="it-header-navbar-wrapper">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="navbar navbar-expand-lg has-megamenu">
                    <button class="custom-navbar-toggler"
                            type="button"
                            aria-controls="nav10"
                            aria-expanded="false"
                            aria-label="Toggle navigation"
                            data-target="#nav10">
                        <svg class="icon">
                            <use xlink:href="{% static 'svg/sprite.svg' %}#it-burger"></use>
                        </svg>
                    </button>
                    <div class="navbar-collapsable" id="nav10">
                        <div class="overlay"></div>
                        <div class="close-div sr-only">
                            <button class="btn close-menu" type="button">
                                <span class="it-close"></span>{% trans "close" %}
                            </button>
                        </div>
                        <div class="menu-wrapper">
                            <ul class="navbar-nav">
                                {% for item in items %}
                                {% is_mega_menu item as is_mega_menu %}
                                <li class="nav-item
                                           {% if forloop.first %}active{% endif %}
                                           {% if item.has_childs %}dropdown{% endif %}
                                           {% if is_mega_menu %}megamenu{% endif %}">
                                    <a class="nav-link dropdown-toggle"
                                       href={% if subitem.link %}"{{ subitem.get_link}}"{% else %}"#"{% endif %}
                                       data-toggle="dropdown" aria-expanded="false">
                                       <span>{{ item.name }}</span>
                                       {% if item.get_childs %}
                                        <svg class="icon icon-xs icon-white">
                                            <use xlink:href="{% static 'svg/sprite.svg' %}#it-expand"></use>
                                        </svg>
                                        {% endif %}
                                    </a>
                                    {% if item.get_childs %}
                                    <div class="dropdown-menu">
                                        <div class="row">
                                            {% for child in item.get_childs %}
                                                {% if child.has_childs %}

                                                    <!-- If previous item hasn't got childs, close col div -->
                                                    {% ifchanged child.has_childs %}
                                                        {% if not forloop.first %}
                                                                </ul>
                                                            </div>
                                                        </div>
                                                        {% endif %}
                                                    {% endifchanged %}

                                                    <!-- Render a full col div -->
                                                    <div class="col-md-auto">
                                                        <div class="link-list-wrapper">
                                                            <ul class="link-list">
                                                                <li>
                                                                    <b>
                                                                        <a class="list-item" href="{{ child.link}}">
                                                                            <span class="text-dark">{{ child.name }}</span>
                                                                        </a>
                                                                    </b>
                                                                </li>
                                                                {% for subchild in child.get_childs %}
                                                                <li>
                                                                    <a class="list-item sub" href="{{ subchild.link}}">
                                                                        <span class="text-dark">{{ subchild.name }}</span>
                                                                    </a>
                                                                </li>
                                                                {% endfor %}
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    <!-- If current item hasn't got childs, render a stack-->
                                                {% else %}

                                                <!-- If previous item has child, render new col, else add items in stack -->
                                                    {% ifchanged child.has_childs %}
                                                    <div class="col-md-auto ">
                                                        <div class="link-list-wrapper">
                                                            <ul class="link-list">
                                                    {% endifchanged %}
                                                                <li>
                                                                    <a class="list-item" href="{{ child.link}}">
                                                                        <span class="text-dark">{{ child.name }}</span>
                                                                    </a>
                                                                </li>

                                                    <!-- If last, close col -->
                                                    {% if forloop.last %}
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    {% endif %}
                                                {% endif %}
                                            {% endfor %}
                                        </div>
                                    </div>
                                    {% endif %}
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</div>
