%path = "physics/circuits/thevenin"
%kind = chindnum["examples"]
%level = 13
<!-- html --><p>We will derive the gain of a band-stop filter using Thevenin’s method.</p>
<p>Our starting circuit is the following from
<a class="reference external" href="http://www.ti.com/lit/an/slod006b/slod006b.pdf">Op Amps for EveryOne (5-10)</a>.</p>
<img class="texfigure align-center" height="182" src="_images/r_dg_c1.png" width="385" />
<p>The input voltage is against the ground. We redraw the circuit to reflect this:</p>
<img class="texfigure align-center" height="182" src="_images/r_dg_c2.png" width="365" />
<p>We want to find <span class="math notranslate nohighlight">\(G=\frac{V_o}{V_i}\)</span>.
<span class="math notranslate nohighlight">\(V_o\)</span> is the voltage at the rightmost R. We will find the Thevenin equivalent there.</p>
<img class="texfigure align-center" height="182" src="_images/r_dg_c3.png" width="371" />
<p>Next we find the currents using Kirchhoff’s current law (KCL) and voltage law (KVL).
There are two loops where current flows.
There is no current at the R at which we have made an open circuit</p>
<img class="texfigure align-center" height="182" src="_images/r_dg_c4.png" width="371" />
<p>The resulting equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l l l}
V_i - I_2 R - \frac{I_2}{iwC} - I_1 R &amp; = 0\\
V_i - \frac{I_1 - I_2}{iwC} - I_1 R &amp; = 0
\end{array}\end{split}\]</div>
<p>We solve for <span class="math notranslate nohighlight">\(I_1\)</span> and <span class="math notranslate nohighlight">\(I_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{l l}
I_1 &amp;= \frac{\omega C V_i (-2 i+C R \omega)}{-1-3 C R i \omega+C^2 R^2 \omega^2}\\
I_2 &amp;= -\frac{i \omega C V_i}{-1-3 C R i \omega+C^2 R^2 \omega^2}
\end{array}\end{split}\]</div>
<p>The small loop at <span class="math notranslate nohighlight">\(V_{th}\)</span> with the now known currents can be used to calculate</p>
<div class="math notranslate nohighlight">
\[V_{th}=\frac{I_2}{iwC} + I_1 R\]</div>
<p>Next we will need the Thevenin impedance equivalent. For this we remove the source <span class="math notranslate nohighlight">\(V_i\)</span>
and calculate the impedance as seen from <span class="math notranslate nohighlight">\(V_{th}\)</span>.</p>
<img class="texfigure align-center" height="162" src="_images/r_dg_c5.png" width="332" />
<p>We redraw to see a little better, what is parallel and what is serial</p>
<img class="texfigure align-center" height="182" src="_images/r_dg_c6.png" width="429" />
<p>With this we get</p>
<div class="math notranslate nohighlight">
\[Z_{th}=\left(\frac{1}{i \omega C}+\frac{R \frac{1}{i \omega C}}{R+\frac{1}{i \omega C}}\right) || R =
\frac{R (1+2 i \omega C R)}{1+3 i \omega C R - C^2 R^2 \omega^2}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[V_o = \frac{R}{R + Z_{th}}\]</div>
<p>Then we finally have the <strong>gain</strong>:</p>
<div class="math notranslate nohighlight">
\[G = \frac{V_o}{V_i} = \frac{(-i+C R \omega)^2}{-2-5 i \omega C R+C^2 R^2 \omega^2}
= \frac{(1+i \omega C R)^2}{2+5 i \omega C R-C^2 R^2 \omega^2}
= \frac{(1+ s\tau)^2}{2+5 s\tau+(s\tau)^2}\]</div>
<p>We have replaced <span class="math notranslate nohighlight">\(\tau=R C\)</span> and <span class="math notranslate nohighlight">\(s=i \omega\)</span>, as is custom for filters.
The denominator can be solved for <span class="math notranslate nohighlight">\(s\tau\)</span> (-4.56,-0.44) and the product of the solutions is 2.
Therefore</p>
<div class="math notranslate nohighlight">
\[G = \frac{(1+ s\tau)^2}{2(1+\frac{s\tau}{0.44})(1+\frac{s\tau}{4.56})}\]</div>
