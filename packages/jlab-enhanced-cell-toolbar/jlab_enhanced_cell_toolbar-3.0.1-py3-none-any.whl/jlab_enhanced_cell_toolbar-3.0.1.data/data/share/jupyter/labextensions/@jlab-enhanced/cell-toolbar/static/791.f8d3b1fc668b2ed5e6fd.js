(self.webpackChunk_jlab_enhanced_cell_toolbar=self.webpackChunk_jlab_enhanced_cell_toolbar||[]).push([[791],{791:(t,e,s)=>{"use strict";s.r(e),s.d(e,{default:()=>x});var a=s(67),n=s(681),o=s(173),l=s(510),i=s(635);const c="@jlab-enhanced/cell-toolbar",d=new o.LabIcon({name:`${c}:code`,svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16px" height="16px">\n    <path d="M0 0h24v24H0V0z" fill="none" />\n    <path class="jp-icon3" fill="#626262" d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z" />\n</svg>'}),h=new o.LabIcon({name:`${c}:delete`,svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16px" height="16px">\n    <path d="M0 0h24v24H0z" fill="none" />\n    <path class="jp-icon3" fill="#626262" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />\n</svg>'}),r=new o.LabIcon({name:`${c}:format`,svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="16px"\n    height="16px" style="-ms-transform: rotate(360deg); -webkit-transform: rotate(360deg); transform: rotate(360deg);"\n    preserveAspectRatio="xMidYMid meet" viewBox="0 0 1792 1792">\n    <path class="jp-icon3"\n        d="M1473 929q7-118-33-226.5t-113-189t-177-131T929 325q-116-7-225.5 32t-192 110.5t-135 175T317 863q-7 118 33 226.5t113 189t177.5 131T862 1467q155 9 293-59t224-195.5t94-283.5zM1792 0l-349 348q120 117 180.5 272t50.5 321q-11 183-102 339t-241 255.5T999 1660L0 1792l347-347q-120-116-180.5-271.5T116 852q11-184 102-340t241.5-255.5T792 132q167-22 500-66t500-66z"\n        fill="#626262" />\n</svg>'}),g=[{className:"jp-enh-cell-to-code",command:"notebook:change-cell-to-code",icon:d,tooltip:"Convert to Code Cell"},{className:"jp-enh-cell-to-md",command:"notebook:change-cell-to-markdown",icon:o.markdownIcon,tooltip:"Convert to Markdown Cell"},{className:"jp-enh-cell-format",command:"jupyterlab_code_formatter:format",icon:r,tooltip:"Format Cell"},{command:"notebook:delete-cell",icon:h,tooltip:"Delete Selected Cells"}];class m extends l.Widget{constructor(t){super(),this.layout=new l.PanelLayout,this.addClass("jp-enh-cell-menu"),this._createMenu(t)}_createMenu(t){const e=this.layout;g.forEach((s=>{t.hasCommand(s.command)&&e.addWidget(new i.ToolbarButton(Object.assign(Object.assign({},s),{onClick:()=>{t.execute(s.command)}})))}))}}var p,u=s(657),_=s(850);class w extends l.Widget{constructor(t,e){super(),this._model=t,this._tagList=e,this.layout=new l.PanelLayout,this.addClass("jp-enh-cell-tags"),this._createTagInput(),e.changed.connect(this.onTagListChanged,this);const s=t.metadata.get("tags")||[];s.length>0?e.pushAll(s):this.refreshTags(),t.metadata.changed.connect(this.onCellMetadataChanged,this)}dispose(){this.isDisposed||(this._model.metadata.changed.disconnect(this.onCellMetadataChanged,this),this._tagList.changed.disconnect(this.onTagListChanged,this),super.dispose())}checkApplied(t){return(this._model.metadata.get("tags")||[]).some((e=>e===t))}addTag(t){const e=this._model.metadata.get("tags")||[],s=t.split(/[,\s]+/).filter((t=>""!==t&&!e.includes(t)));this._model.metadata.set("tags",[...e,...s])}removeTag(t){const e=[...this._model.metadata.get("tags")||[]],s=e.indexOf(t);s>-1&&e.splice(s,1),0===e.length?this._model.metadata.delete("tags"):this._model.metadata.set("tags",e)}refreshTags(){const t=this.layout,e=[...new Set((0,_.toArray)(this._tagList))],s=new Array;t.widgets.forEach((t=>{if("add-tag"!==t.id){const a=e.indexOf(t.name);a<0?s.push(t):e.splice(a,1)}})),s.forEach((t=>t.dispose())),e.forEach((e=>{t.insertWidget(this.layout.widgets.length-1,new u.TagWidget(e))})),t.widgets.forEach((t=>{t.update()}))}_createTagInput(){const t=this.layout,e=new u.AddWidget;e.id="add-tag",t.addWidget(e)}_validateTags(t){const e=new Set;return t.filter((t=>"string"==typeof t&&""!==t)).forEach((t=>{t.split(/[,\s]+/).forEach((t=>{""!==t&&e.add(t)}))})),[...e]}onCellMetadataChanged(t,e){if("tags"===e.key){const t=[...new Set(e.oldValue||[])],s=this._validateTags(e.newValue||[]);t.forEach((t=>{s.includes(t)||this._tagList.removeValue(t)})),this._tagList.pushAll(s.filter((e=>!t.includes(e))))}}onTagListChanged(t,e){this.refreshTags()}}class f extends l.Widget{constructor(t,e,s){super(),this.layout=new l.PanelLayout,this._create(t,e,s),this.addClass("jp-enh-cell-toolbar")}_create(t,e,s){const a=this.layout;a.addWidget(new m(t)),a.addWidget(new w(e,s))}}class b extends l.Widget{constructor(t){super({node:p.createNode(t)}),this.addClass("jp-enh-cell-button"),this._callback=t.callback}handleEvent(t){switch(t.type){case"mousedown":this._evtMouseDown(t)}}onBeforeAttach(t){this.node.addEventListener("mousedown",this)}onAfterDetach(t){this.node.removeEventListener("mousedown",this)}_evtMouseDown(t){0===t.button&&(t.preventDefault(),t.stopPropagation(),this._callback())}}!function(t){t.createNode=function(t){const e=document.createElement("button");return t.tooltip&&(e.title=t.tooltip),t.className&&e.classList.add(t.className),e.appendChild(t.icon.element({elementPosition:"center",elementSize:"normal",tag:"span"})),e}}(p||(p={}));const v=[{className:"jp-enh-cell-run",command:"notebook:run-cell",icon:o.runIcon,tooltip:"Run Selected Cells"},{className:"jp-enh-cell-up",command:"notebook:move-cell-up",icon:o.caretUpEmptyThinIcon,tooltip:"Move Selected Cells Up"},{className:"jp-enh-cell-down",command:"notebook:move-cell-down",icon:o.caretDownEmptyThinIcon,tooltip:"Move Selected Cells Down"},{className:"jp-enh-cell-insert",command:"notebook:insert-cell-below",icon:o.addIcon,tooltip:"Insert Cell"}],C="jp-enh-cell-bar";class T{constructor(t,e,s){this._allTags=new n.ObservableList,this._isDisposed=!1,this._previousDefaultTags=new Array,this._commands=e,this._panel=t,this._settings=s,this._settings&&(this._onSettingsChanged(),this._settings.changed.connect(this._onSettingsChanged,this)),this._panel.context.model.cells.changed.connect(this.updateConnectedCells,this)}get isDisposed(){return this._isDisposed}dispose(){this.isDisposed||(this._isDisposed=!0,this._settings&&this._settings.changed.disconnect(this._onSettingsChanged,this),this._panel.context.model.cells.changed.disconnect(this.updateConnectedCells,this),this._panel=null)}updateConnectedCells(t,e){e.oldValues.forEach((t=>this._removeToolbar(t))),e.newValues.forEach((t=>this._addToolbar(t)))}_addToolbar(t){const e=this._getCell(t);if(e){const s=new f(this._commands,t,this._allTags);s.addClass(C),e.layout.insertWidget(0,s),v.forEach((t=>{if(this._commands.hasCommand(t.command)){const{className:s,command:a}=t,n=function(t,e){var s={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(s[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(s[a[n]]=t[a[n]])}return s}(t,["className","command"]),o=new b(Object.assign(Object.assign({},n),{callback:()=>{this._commands.execute(a)}}));o.addClass(C),s&&o.addClass(s),e.layout.addWidget(o)}}))}}_getCell(t){return this._panel.content.widgets.find((e=>e.model===t))}_findToolbarWidgets(t){return t.layout.widgets.filter((t=>t.hasClass(C)))||[]}_removeToolbar(t){const e=this._getCell(t);e&&this._findToolbarWidgets(e).forEach((t=>t.dispose()))}_onSettingsChanged(){const t=this._settings.composite.defaultTags||[],e=t.filter((t=>!this._previousDefaultTags.includes(t)));e.length>0&&this._allTags.pushAll(e),this._previousDefaultTags.filter((e=>!t.includes(e))).forEach((t=>this._allTags.removeValue(t))),this._previousDefaultTags=t}}class y{constructor(t,e){this._commands=t,this._settings=e}createNew(t){return new T(t,this._commands,this._settings)}}const x={id:`${c}:plugin`,autoStart:!0,activate:async(t,e)=>{const s=await e.load(`${c}:plugin`);t.docRegistry.addWidgetExtension("Notebook",new y(t.commands,s))},optional:[a.ISettingRegistry]}}}]);