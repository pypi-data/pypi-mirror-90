---

title: Tabular Binary Classification (Beginner)


keywords: fastai
sidebar: home_sidebar

summary: "Introducing the Tabular API with an example problem"
description: "Introducing the Tabular API with an example problem"
nb_path: "nbs/03_tab.clas.binary.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/03_tab.clas.binary.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<hr>
<p>This article is also a Jupyter Notebook available to be run from the top down. There will be code snippets that you can then run in any environment. Below are the versions of <code>fastai</code> and <code>fastcore</code> currently running at the time of writing this:</p>
<ul>
<li><code>fastai</code>: 2.0.14 </li>
<li><code>fastcore</code>: 1.0.11 </li>
</ul>
<hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Binary-Classification">Binary Classification<a class="anchor-link" href="#Binary-Classification"> </a></h2><p>In this example we will be walking through the <code>fastai</code> tabular API to perform binary classification on the Salary dataset.</p>
<p>This notebook can run along side the first tabular lesson from Walk with fastai2, shown <a href="https://www.youtube.com/watch?v=liTHAhdl1cQ&amp;list=PLFDkaGxp5BXDvj3oHoKDgEcH73Aze-eET&amp;index=9&amp;t=430s">here</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we need to call the tabular module:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.tabular.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And grab our dataset:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">ADULT_SAMPLE</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we look at the contents of our folder, we will find our data lives in <code>adult.csv</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [Path(&#39;/home/ml1/.fastai/data/adult_sample/models&#39;),Path(&#39;/home/ml1/.fastai/data/adult_sample/export.pkl&#39;),Path(&#39;/home/ml1/.fastai/data/adult_sample/adult.csv&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll go ahead and open it in <code>Pandas</code> and take a look:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;adult.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>NaN</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Private</td>
      <td>236746</td>
      <td>Masters</td>
      <td>14.0</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>96185</td>
      <td>HS-grad</td>
      <td>NaN</td>
      <td>Divorced</td>
      <td>NaN</td>
      <td>Unmarried</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>Self-emp-inc</td>
      <td>112847</td>
      <td>Prof-school</td>
      <td>15.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>Asian-Pac-Islander</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Self-emp-not-inc</td>
      <td>82297</td>
      <td>7th-8th</td>
      <td>NaN</td>
      <td>Married-civ-spouse</td>
      <td>Other-service</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>United-States</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="TabularPandas">TabularPandas<a class="anchor-link" href="#TabularPandas"> </a></h2><p><code>fastai</code> has a new way of dealing with tabular data by utilizing a <a href="https://docs.fast.ai/tabular.core#TabularPandas"><code>TabularPandas</code></a> object. It expects some dataframe, some <code>procs</code>, <code>cat_names</code>, <code>cont_names</code>, <code>y_names</code>, <code>y_block</code>, and some <code>splits</code>. We'll walk through all of them</p>
<p>First we need to grab our categorical and continuous variables, along with how we want to process our data.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we pre-process tabular data with <code>fastai</code>, we do one or more of three transforms:</p>
<ul>
<li><a href="/tab.stats.html#Categorify"><code>Categorify</code></a></li>
<li><a href="/tab.stats.html#FillMissing"><code>FillMissing</code></a></li>
<li><a href="https://docs.fast.ai/data.transforms#Normalize"><code>Normalize</code></a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Categorify">Categorify<a class="anchor-link" href="#Categorify"> </a></h3><p><a href="/tab.stats.html#Categorify"><code>Categorify</code></a> will transform columns that are in your <code>cat_names</code> into that type, along with label encoding our categorical data.</p>
<p>First we'll make an instance of it:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">Categorify</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now let's try transforming a dataframe</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cat</span><span class="p">,</span> <span class="n">cat_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then extract that transform from <code>to.procs.categorify</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cats</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">procs</span><span class="o">.</span><span class="n">categorify</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a look at the categories:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cats</span><span class="p">[</span><span class="s1">&#39;relationship&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#7) [&#39;#na#&#39;,&#39; Husband&#39;,&#39; Not-in-family&#39;,&#39; Other-relative&#39;,&#39; Own-child&#39;,&#39; Unmarried&#39;,&#39; Wife&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that it added a <code>#na#</code>category. Let's look at the actual column:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">max_n</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Private</td>
      <td>Assoc-acdm</td>
      <td>Married-civ-spouse</td>
      <td>#na#</td>
      <td>Wife</td>
      <td>White</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Private</td>
      <td>Masters</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Divorced</td>
      <td>#na#</td>
      <td>Unmarried</td>
      <td>Black</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see now, for example, that <code>occupation</code> got returned a <code>#na#</code>value (as it was missing)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we call <code>to.cats</code> we can see our one-hot encoded variables:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">cats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>8</td>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>13</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>12</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6</td>
      <td>15</td>
      <td>3</td>
      <td>11</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>7</td>
      <td>6</td>
      <td>3</td>
      <td>9</td>
      <td>6</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Normalize">Normalize<a class="anchor-link" href="#Normalize"> </a></h3><p>To properly work with our numerical columns, we need to show a relationship between them all that our model can understand. This is commonly done through Normalization, where we scale the data between -1 and 1, and compute a <code>z-score</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">norm</span> <span class="o">=</span> <span class="n">Normalize</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's make another <code>to</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">norm</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">norms</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">procs</span><span class="o">.</span><span class="n">normalize</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And take a closer look.</p>
<p>We can grab the means and standard deviations like so:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">norms</span><span class="o">.</span><span class="n">means</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;age&#39;: 38.58164675532078,
 &#39;fnlwgt&#39;: 189778.36651208502,
 &#39;education-num&#39;: 10.079815426825466}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">norms</span><span class="o">.</span><span class="n">stds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;age&#39;: 13.64022319230403,
 &#39;fnlwgt&#39;: 105548.3568809906,
 &#39;education-num&#39;: 2.5729591440613078}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can also call <code>to.conts</code> to take a look at our transformed data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">conts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.763796</td>
      <td>-0.838084</td>
      <td>0.746294</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.397233</td>
      <td>0.444987</td>
      <td>1.523609</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.042642</td>
      <td>-0.886734</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.042642</td>
      <td>-0.728873</td>
      <td>1.912267</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.250608</td>
      <td>-1.018314</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="FillMissing">FillMissing<a class="anchor-link" href="#FillMissing"> </a></h3><p>Now the last thing we need to do is take care of any missing values in our <strong>continuous</strong> variables (we have a special <code>#na#</code> for categorical data already). We have three strategies we can use:</p>
<ul>
<li><code>median</code></li>
<li><code>mode</code></li>
<li><code>constant</code></li>
</ul>
<p>By default it uses <code>median</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fm</span> <span class="o">=</span> <span class="n">FillMissing</span><span class="p">(</span><span class="n">fill_strategy</span><span class="o">=</span><span class="n">FillStrategy</span><span class="o">.</span><span class="n">median</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll recreate another <a href="https://docs.fast.ai/tabular.core#TabularPandas"><code>TabularPandas</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">fm</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at those missing values in the first few rows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">conts</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>101320</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>236746</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>96185</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>112847</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>82297</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>But wait!</strong> There's more!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">cat_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#1) [&#39;education-num_na&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have categorical values?! Yes!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">cats</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>education-num_na</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now have an additional boolean value based on if the value was missing or not too!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-DataLoaders">The DataLoaders<a class="anchor-link" href="#The-DataLoaders"> </a></h2><p>Now let's build our <a href="https://docs.fast.ai/tabular.core#TabularPandas"><code>TabularPandas</code></a> for classifying. We're also going to want to split our data and declare our <code>y_names</code> too:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">RandomSplitter</span><span class="p">()(</span><span class="n">range_of</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
<span class="n">splits</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#26049) [18724,19703,4062,9102,28824,4054,5833,16188,2731,28161...],
 (#6512) [24465,976,1726,10178,4740,3920,32288,26018,20274,9660...])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What is <a href="https://fastcore.fast.ai/basics#range_of"><code>range_of</code></a>?</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">range_of</span><span class="p">(</span><span class="n">df</span><span class="p">)[:</span><span class="mi">5</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([0, 1, 2, 3, 4], 32561)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's a list of total index's in our <code>DataFrame</code></p>
<p>We'll use all our <code>cat</code> and <code>cont</code> names, the <code>procs</code>, declare a <code>y_name</code>, and finally specify a single-label classification problem with <a href="https://docs.fast.ai/data.block#CategoryBlock"><code>CategoryBlock</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cat_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">,</span> <span class="s1">&#39;education&#39;</span><span class="p">,</span> <span class="s1">&#39;marital-status&#39;</span><span class="p">,</span> <span class="s1">&#39;occupation&#39;</span><span class="p">,</span> <span class="s1">&#39;relationship&#39;</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">]</span>
<span class="n">cont_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;fnlwgt&#39;</span><span class="p">,</span> <span class="s1">&#39;education-num&#39;</span><span class="p">]</span>
<span class="n">procs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Categorify</span><span class="p">,</span> <span class="n">FillMissing</span><span class="p">,</span> <span class="n">Normalize</span><span class="p">]</span>
<span class="n">y_names</span> <span class="o">=</span> <span class="s1">&#39;salary&#39;</span>
<span class="n">y_block</span> <span class="o">=</span> <span class="n">CategoryBlock</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have everything declared, let's build our <a href="https://docs.fast.ai/tabular.core#TabularPandas"><code>TabularPandas</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span> <span class="o">=</span> <span class="n">TabularPandas</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">procs</span><span class="o">=</span><span class="n">procs</span><span class="p">,</span> <span class="n">cat_names</span><span class="o">=</span><span class="n">cat_names</span><span class="p">,</span> <span class="n">cont_names</span><span class="o">=</span><span class="n">cont_names</span><span class="p">,</span>
                   <span class="n">y_names</span><span class="o">=</span><span class="n">y_names</span><span class="p">,</span> <span class="n">y_block</span><span class="o">=</span><span class="n">y_block</span><span class="p">,</span> <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we can build the <a href="https://docs.fast.ai/data.core#DataLoaders"><code>DataLoaders</code></a>. We can do this one of two ways, first just calling <code>to.dataloaders()</code> on our data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or we can create the <a href="https://docs.fast.ai/data.core#DataLoaders"><code>DataLoaders</code></a> ourselves (a train and valid). One great reason to do this this way is we can pass in different batch sizes into each <a href="https://docs.fast.ai/tabular.core#TabDataLoader"><code>TabDataLoader</code></a>, along with changing options like <code>shuffle</code> and <code>drop_last</code></p>
<p>So how do we use it? Our train and validation data live in to.train and to.valid right now, so we specify that along with our options. When you make a training DataLoader, you want <code>shuffle</code> to be <code>True</code> and <code>drop_last</code> to be <code>True</code> (so we drop the last incomplete batch)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trn_dl</span> <span class="o">=</span> <span class="n">TabDataLoader</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">val_dl</span> <span class="o">=</span> <span class="n">TabDataLoader</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">valid</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can make some <a href="https://docs.fast.ai/data.core#DataLoaders"><code>DataLoaders</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="p">(</span><span class="n">trn_dl</span><span class="p">,</span> <span class="n">val_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And show a batch of data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Private</td>
      <td>11th</td>
      <td>Never-married</td>
      <td>Sales</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>17.0</td>
      <td>200199.000263</td>
      <td>7.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>False</td>
      <td>36.0</td>
      <td>256635.997971</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Transport-moving</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>44.0</td>
      <td>172032.000108</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Self-emp-not-inc</td>
      <td>5th-6th</td>
      <td>Married-civ-spouse</td>
      <td>Craft-repair</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>44.0</td>
      <td>112506.998184</td>
      <td>3.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Local-gov</td>
      <td>Some-college</td>
      <td>Never-married</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>False</td>
      <td>40.0</td>
      <td>74949.002528</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>5</th>
      <td>?</td>
      <td>10th</td>
      <td>Never-married</td>
      <td>?</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>17.0</td>
      <td>138506.999270</td>
      <td>6.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Private</td>
      <td>Assoc-voc</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Wife</td>
      <td>White</td>
      <td>False</td>
      <td>28.0</td>
      <td>247819.002902</td>
      <td>11.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Private</td>
      <td>Masters</td>
      <td>Married-civ-spouse</td>
      <td>Exec-managerial</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>37.0</td>
      <td>112496.998941</td>
      <td>14.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Separated</td>
      <td>Handlers-cleaners</td>
      <td>Not-in-family</td>
      <td>Black</td>
      <td>False</td>
      <td>41.0</td>
      <td>215479.000444</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Private</td>
      <td>Assoc-voc</td>
      <td>Divorced</td>
      <td>Sales</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>31.0</td>
      <td>163302.999641</td>
      <td>11.0</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Why can we do the <code>.dataloaders()</code>? Because <a href="https://docs.fast.ai/tabular.core#TabularPandas"><code>TabularPandas</code></a> itself is actually a set of <code>TabDataLoaders</code>! See below for a comparison test:</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">_dbunch_type</span> <span class="o">==</span> <span class="n">dls</span><span class="o">.</span><span class="n">_dbunch_type</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tabular-Learner-and-Training-a-Model">Tabular Learner and Training a Model<a class="anchor-link" href="#Tabular-Learner-and-Training-a-Model"> </a></h2><p>Now we can build our <a href="https://docs.fast.ai/learner#Learner"><code>Learner</code></a>! But what's special about a tabular neural network?</p>
<h3 id="Categorical-Variables">Categorical Variables<a class="anchor-link" href="#Categorical-Variables"> </a></h3><p>When dealing with our categorical data, we create what is called an <strong>embedding matrix</strong>. This allows for a higher dimentionality for relationships between the different categorical cardinalities. Finding the best size ratio was done through experiments by Jeremy on the Rossmann dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This "rule of thumb" is to use either a maximum embedding space of 600, or 1.6 times the cardinality raised to the 0.56, or written out as:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% raw %}
$$min(600, (1.6 * {var.nunique)}^{0.56})$$
{% endraw %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's calculate these embedding sizes for our model to take a look-see:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emb_szs</span> <span class="o">=</span> <span class="n">get_emb_sz</span><span class="p">(</span><span class="n">to</span><span class="p">);</span> <span class="n">emb_szs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[(10, 6), (17, 8), (8, 5), (16, 8), (7, 5), (6, 4), (3, 3)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want to see what each one aligns to, let's look at the order of <code>cat_names</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="o">.</span><span class="n">cat_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#7) [&#39;workclass&#39;,&#39;education&#39;,&#39;marital-status&#39;,&#39;occupation&#39;,&#39;relationship&#39;,&#39;race&#39;,&#39;education-num_na&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's specifically look at <code>workclass</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">to</span><span class="p">[</span><span class="s1">&#39;workclass&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you notice, we had <code>10</code> there, this is to take one more column for any missing categorical values that may show</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numerical-Variables">Numerical Variables<a class="anchor-link" href="#Numerical-Variables"> </a></h3><p>Numericals we can simply pass in how many there are to the model:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cont_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">cont_names</span><span class="p">);</span> <span class="n">cont_len</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we have all the pieces we need to build a <a href="https://docs.fast.ai/tabular.model#TabularModel"><code>TabularModel</code></a>!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="TabularModel">TabularModel<a class="anchor-link" href="#TabularModel"> </a></h3><p>What makes this model a little different is our batches is actually two inputs:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([ 5, 12,  5,  5,  2,  5,  1]), tensor([-0.1858, -0.4134, -0.4253]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the first being our categorical variables and the second being our numericals.</p>
<p>Now let's make our model. We'll want our size of our embeddings, the number of continuous variables, the number of outputs, and how large and how many fully connected layers we want to use:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">TabularModel</span><span class="p">(</span><span class="n">emb_szs</span><span class="p">,</span> <span class="n">cont_len</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see it's architecture:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TabularModel(
  (embeds): ModuleList(
    (0): Embedding(10, 6)
    (1): Embedding(17, 8)
    (2): Embedding(8, 5)
    (3): Embedding(16, 8)
    (4): Embedding(7, 5)
    (5): Embedding(6, 4)
    (6): Embedding(3, 3)
  )
  (emb_drop): Dropout(p=0.0, inplace=False)
  (bn_cont): BatchNorm1d(3, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (layers): Sequential(
    (0): LinBnDrop(
      (0): BatchNorm1d(42, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): Linear(in_features=42, out_features=200, bias=False)
      (2): ReLU(inplace=True)
    )
    (1): LinBnDrop(
      (0): BatchNorm1d(200, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (1): Linear(in_features=200, out_features=100, bias=False)
      (2): ReLU(inplace=True)
    )
    (2): LinBnDrop(
      (0): Linear(in_features=100, out_features=2, bias=True)
    )
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="tabular_learner">tabular_learner<a class="anchor-link" href="#tabular_learner"> </a></h3><p>Now that we know the background, let's build our model a little bit faster and generate a <a href="https://docs.fast.ai/learner#Learner"><code>Learner</code></a> too:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we can fit!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.0013182567432522773, lr_steep=1.3182567358016968)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.373488</td>
      <td>0.362226</td>
      <td>0.841523</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.367182</td>
      <td>0.354484</td>
      <td>0.838759</td>
      <td>00:03</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.368737</td>
      <td>0.355205</td>
      <td>0.834306</td>
      <td>00:03</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Can we speed this up a little? Yes we can! The more you can load into a batch, the faster you can process the data. This is a careful balance, for tabular data I go to a maximum of 4096 rows per batch if the dataset is large enough for a decent number of batches:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.389950</td>
      <td>0.407716</td>
      <td>0.812500</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.366711</td>
      <td>0.350281</td>
      <td>0.839681</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.357688</td>
      <td>0.355638</td>
      <td>0.836763</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see we fit very quickly, but it didn't fit quite as well (there is a trade-off):</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">to</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">4096</span><span class="p">)</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">tabular_learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.449081</td>
      <td>0.503046</td>
      <td>0.772267</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.407749</td>
      <td>0.465814</td>
      <td>0.758446</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.387042</td>
      <td>0.445514</td>
      <td>0.776720</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Inference">Inference<a class="anchor-link" href="#Inference"> </a></h2><p>Now let's look at how we can perform inference. To do predictions we can use <code>fastai</code>'s in-house <code>learn.predict</code> for individual rows, and <code>get_preds</code> + <code>test_dl</code> for batches of predictions:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">row</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Private</td>
      <td>Assoc-acdm</td>
      <td>Married-civ-spouse</td>
      <td>#na#</td>
      <td>Wife</td>
      <td>White</td>
      <td>False</td>
      <td>49.0</td>
      <td>101320.00007</td>
      <td>12.0</td>
      <td>&lt;50k</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's try <code>test_dl</code>. There's something special we can do here too:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at a batch:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>workclass</th>
      <th>education</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>education-num_na</th>
      <th>age</th>
      <th>fnlwgt</th>
      <th>education-num</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Private</td>
      <td>Assoc-acdm</td>
      <td>Married-civ-spouse</td>
      <td>#na#</td>
      <td>Wife</td>
      <td>White</td>
      <td>False</td>
      <td>49.0</td>
      <td>101320.000070</td>
      <td>12.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Private</td>
      <td>Masters</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>False</td>
      <td>44.0</td>
      <td>236745.999937</td>
      <td>14.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Divorced</td>
      <td>#na#</td>
      <td>Unmarried</td>
      <td>Black</td>
      <td>True</td>
      <td>38.0</td>
      <td>96185.001851</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Self-emp-inc</td>
      <td>Prof-school</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>Asian-Pac-Islander</td>
      <td>False</td>
      <td>38.0</td>
      <td>112846.997614</td>
      <td>15.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Self-emp-not-inc</td>
      <td>7th-8th</td>
      <td>Married-civ-spouse</td>
      <td>Other-service</td>
      <td>Wife</td>
      <td>Black</td>
      <td>True</td>
      <td>42.0</td>
      <td>82296.994924</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Never-married</td>
      <td>Handlers-cleaners</td>
      <td>Own-child</td>
      <td>White</td>
      <td>False</td>
      <td>20.0</td>
      <td>63210.003417</td>
      <td>9.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Private</td>
      <td>Some-college</td>
      <td>Divorced</td>
      <td>#na#</td>
      <td>Other-relative</td>
      <td>White</td>
      <td>False</td>
      <td>49.0</td>
      <td>44434.000334</td>
      <td>10.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Private</td>
      <td>11th</td>
      <td>Married-civ-spouse</td>
      <td>#na#</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>37.0</td>
      <td>138939.999209</td>
      <td>7.0</td>
      <td>&lt;50k</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Private</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>Craft-repair</td>
      <td>Husband</td>
      <td>White</td>
      <td>False</td>
      <td>46.0</td>
      <td>328215.996478</td>
      <td>9.0</td>
      <td>&gt;=50k</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Self-emp-inc</td>
      <td>HS-grad</td>
      <td>Married-civ-spouse</td>
      <td>#na#</td>
      <td>Husband</td>
      <td>White</td>
      <td>True</td>
      <td>36.0</td>
      <td>216711.000298</td>
      <td>10.0</td>
      <td>&gt;=50k</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have our labels! It'll grab them if possible by default!</p>
<p>What does that mean? Well, besides simply calling <code>get_preds</code>, we can also run <code>validate</code> to see how a model performs. This is nice as it can allow for efficient methods when calculating something like permutation importance:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [0.4870152175426483,0.7699999809265137]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll also show an example of <code>get_preds</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.5952, 0.4048])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What would happen if I accidently passed in an unlablled dataset to <code>learn.validate</code> though? Let's find out:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;salary&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>workclass</th>
      <th>fnlwgt</th>
      <th>education</th>
      <th>education-num</th>
      <th>marital-status</th>
      <th>occupation</th>
      <th>relationship</th>
      <th>race</th>
      <th>sex</th>
      <th>capital-gain</th>
      <th>capital-loss</th>
      <th>hours-per-week</th>
      <th>native-country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>49</td>
      <td>Private</td>
      <td>101320</td>
      <td>Assoc-acdm</td>
      <td>12.0</td>
      <td>Married-civ-spouse</td>
      <td>NaN</td>
      <td>Wife</td>
      <td>White</td>
      <td>Female</td>
      <td>0</td>
      <td>1902</td>
      <td>40</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>1</th>
      <td>44</td>
      <td>Private</td>
      <td>236746</td>
      <td>Masters</td>
      <td>14.0</td>
      <td>Divorced</td>
      <td>Exec-managerial</td>
      <td>Not-in-family</td>
      <td>White</td>
      <td>Male</td>
      <td>10520</td>
      <td>0</td>
      <td>45</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>2</th>
      <td>38</td>
      <td>Private</td>
      <td>96185</td>
      <td>HS-grad</td>
      <td>NaN</td>
      <td>Divorced</td>
      <td>NaN</td>
      <td>Unmarried</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>32</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>Self-emp-inc</td>
      <td>112847</td>
      <td>Prof-school</td>
      <td>15.0</td>
      <td>Married-civ-spouse</td>
      <td>Prof-specialty</td>
      <td>Husband</td>
      <td>Asian-Pac-Islander</td>
      <td>Male</td>
      <td>0</td>
      <td>0</td>
      <td>40</td>
      <td>United-States</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Self-emp-not-inc</td>
      <td>82297</td>
      <td>7th-8th</td>
      <td>NaN</td>
      <td>Married-civ-spouse</td>
      <td>Other-service</td>
      <td>Wife</td>
      <td>Black</td>
      <td>Female</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>United-States</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">dls</span><span class="o">.</span><span class="n">test_dl</span><span class="p">(</span><span class="n">df2</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="n">dl</span><span class="o">=</span><span class="n">dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [None,None]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see it will simply just return <code>None</code>!</p>

</div>
</div>
</div>
</div>
 

