---

title: Lesson 2 - Image Classification Models from Scratch


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/course2020/vision/02_MNIST.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/course2020/vision/02_MNIST.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Lesson-Video:">Lesson Video:<a class="anchor-link" href="#Lesson-Video:"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe
            width="400"
            height="300"
            src="https://www.youtube.com/embed/_SKqrTlXNt8"
            frameborder="0"
            allowfullscreen
        ></iframe>
        
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea output_execute_result">
<hr>
<p>This article is also a Jupyter Notebook available to be run from the top down. There
will be code snippets that you can then run in any environment.</p>
<p>Below are the versions of <code>fastai</code>, <code>fastcore</code>, and <code>wwf</code> currently running at the time of writing this:</p>
<ul>
<li><code>fastai</code>: 2.1.10 </li>
<li><code>fastcore</code>: 1.3.13 </li>
<li><code>wwf</code>: 0.0.5 </li>
</ul>
<hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Grab our vision related libraries</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.vision.all</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below you will find the exact imports for everything we use today</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="kn">from</span> <span class="nn">fastai.callback.hook</span> <span class="kn">import</span> <span class="n">summary</span>
<span class="kn">from</span> <span class="nn">fastai.callback.schedule</span> <span class="kn">import</span> <span class="n">fit_one_cycle</span><span class="p">,</span> <span class="n">lr_find</span> 
<span class="kn">from</span> <span class="nn">fastai.callback.progress</span> <span class="kn">import</span> <span class="n">ProgressCallback</span>

<span class="kn">from</span> <span class="nn">fastai.data.core</span> <span class="kn">import</span> <span class="n">Datasets</span><span class="p">,</span> <span class="n">DataLoaders</span><span class="p">,</span> <span class="n">show_at</span>
<span class="kn">from</span> <span class="nn">fastai.data.external</span> <span class="kn">import</span> <span class="n">untar_data</span><span class="p">,</span> <span class="n">URLs</span>
<span class="kn">from</span> <span class="nn">fastai.data.transforms</span> <span class="kn">import</span> <span class="n">Categorize</span><span class="p">,</span> <span class="n">GrandparentSplitter</span><span class="p">,</span> <span class="n">parent_label</span><span class="p">,</span> <span class="n">ToTensor</span><span class="p">,</span> <span class="n">IntToFloatTensor</span><span class="p">,</span> <span class="n">Normalize</span>

<span class="kn">from</span> <span class="nn">fastai.layers</span> <span class="kn">import</span> <span class="n">Flatten</span>
<span class="kn">from</span> <span class="nn">fastai.learner</span> <span class="kn">import</span> <span class="n">Learner</span>

<span class="kn">from</span> <span class="nn">fastai.metrics</span> <span class="kn">import</span> <span class="n">accuracy</span><span class="p">,</span> <span class="n">CrossEntropyLossFlat</span>

<span class="kn">from</span> <span class="nn">fastai.vision.augment</span> <span class="kn">import</span> <span class="n">CropPad</span><span class="p">,</span> <span class="n">RandomCrop</span><span class="p">,</span> <span class="n">PadMode</span>
<span class="kn">from</span> <span class="nn">fastai.vision.core</span> <span class="kn">import</span> <span class="n">PILImageBW</span>
<span class="kn">from</span> <span class="nn">fastai.vision.utils</span> <span class="kn">import</span> <span class="n">get_image_files</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And our data</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Working-with-the-data">Working with the data<a class="anchor-link" href="#Working-with-the-data"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span> <span class="o">=</span> <span class="n">get_image_files</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Path(&#39;/root/.fastai/data/mnist_png/testing/3/4044.png&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create an image object. Done automatically with <a href="https://docs.fast.ai/vision.data#ImageBlock"><code>ImageBlock</code></a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">PILImageBW</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0dd07260b8&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Split our data with <a href="https://docs.fast.ai/data.transforms#GrandparentSplitter"><code>GrandparentSplitter</code></a>, which will make use of a <code>train</code> and <code>valid</code> folder.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">GrandparentSplitter</span><span class="p">(</span><span class="n">train_name</span><span class="o">=</span><span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="n">valid_name</span><span class="o">=</span><span class="s1">&#39;testing&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#3) [Path(&#39;/root/.fastai/data/mnist_png/testing/3/4044.png&#39;),Path(&#39;/root/.fastai/data/mnist_png/testing/3/1205.png&#39;),Path(&#39;/root/.fastai/data/mnist_png/testing/3/3916.png&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Splits need to be applied to some items</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span> <span class="o">=</span> <span class="n">splits</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">5</span><span class="p">],</span> <span class="n">splits</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([10000, 10001, 10002, 10003, 10004], [0, 1, 2, 3, 4])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p>Make a <a href="https://docs.fast.ai/data.core#Datasets"><code>Datasets</code></a></p>
</li>
<li><p>Expects items, transforms for describing our problem, and a splitting method</p>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dsrc</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">tfms</span><span class="o">=</span><span class="p">[[</span><span class="n">PILImageBW</span><span class="o">.</span><span class="n">create</span><span class="p">],</span> <span class="p">[</span><span class="n">parent_label</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">]],</span> 
                  <span class="n">splits</span><span class="o">=</span><span class="n">splits</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can look at an item in our <a href="https://docs.fast.ai/data.core#Datasets"><code>Datasets</code></a> with <a href="https://docs.fast.ai/data.core#show_at"><code>show_at</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_at</span><span class="p">(</span><span class="n">dsrc</span><span class="o">.</span><span class="n">train</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7f0dd06abef0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAABUCAYAAAA7xZEpAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAI4UlEQVR4nO2bz08bZxrHP6/HY2OMDZhATNkAKaQ4PyhpKkshOWQVtd1D+AN2bznsZQ/9C3LJHve6h73sqVKOq/YSJU2TlVJpq6ZqEEkrU+RSgxO7NjYGm2CMmV97SGYKUwfa1Paw2flIlrBn3plnvvO8z/u8z/siDMPA5Sc8Thtw2HAFseEKYsMVxIYriA1XEBuuIDYcF0QIcUMIkRNCbAghkkKIPztqj9OJmRDiNLBoGEZdCBED7gNXDMOYdcIexz3EMIyEYRh18+uLz5hT9jguCIAQ4h9CiC1gAcgBtxyzxekuYyKEkIBp4PfA3wzDUJyw41B4CIBhGJphGP8Bfgf8xSk7Do0gu/Dy/xpDhBADQog/CiG6hBCSEOIPwJ+Afztmk5MxRAjRD/wLmOL5y0kDfzcM45+O2XRYguph4TDGEEdxBbHhCmLDFcSG94Djr3PEFY1+dD3EhiuIDVcQG64gNlxBbLiC2HAFseEKYuOgxOxXo+s6mqaxvb1NsVhE0zQ0TbOO+/1+AoEAgUCAjo4OvF4vkiQ124xXpumCqKrK5uYmc3NzXLt2jbW1NUqlknX8zJkzxONxpqenOX/+PN3d3XR1dTXbjFem6YJ4PB68Xi9+v5+enh4qlQqVSgWz7pJOp+nt7UWWZSRJ4siRI0QiEfx+Pz6fj1AoZHmO19t08w7koALRr57LGIaBrutkMhk++ugjEokEH3/8MbquA88F83g8+Hw+68FlWSYWizE2Nsbly5c5d+4cAwMDhEKhV3ysX0TDuYx0/fr1/Rrte7DhXYRACIGu65Y4Gxsb+Hw+FEVBCIGqqui6jqqq7OzsUK/X0TQNXdfRdZ2dnR1qtRqbm5vWdTweT7NjzV8b2t9sDzExHziXy3Hr1i3m5+e5c+cOlUplT0zZY4wQVsDt7Oyks7OTq1evcunSJSYmJuju7n5VcxrertGPLeukQgi8Xi/d3d28++67eL1eCoUChUKBJ0+esL29zdbWluUhhmFgGAb1eh1d11EUhVqtxvz8PB6Ph0AgwMjICIFAAFmWW2V26zzEusCL62ezWe7du0cmk2F5eZliscji4iKlUonV1VV22yHETy/P9JQPP/yQ9957j1gs1ixPaa+HWHd98XDhcJizZ88yNjbGyZMnKRQK5PN5nj59yg8//MDS0hLZbPZn7RVFoVqtkslkSCQSjIyMNLvr7KFt41o4HGZqasr6Xq/X2d7eJpVK8fDhQz777DM++eSTn7VTFAVFUZibm6NarXLhwgWi0WjL7GzrQL+7K5i5SjAYJBQK4fP59m1rjlitpv2Zj3njF4lXKBSyErPDgGOC1Go1KpUKyWSSL7/8kkwms+/55hyo1fMexwQpl8s8evSIzz//nDt37pDP5/c93+xar50gZjZaLBb54osvWFxcpFAoUK1WG55vzo3eeustLl682Op03hlBVFUlnU7z6aefksvlWFlZ4WX5kBl83377baanp18fQcxMtFarUSwWSSaT5HK5l3qGSTweJxaLMTk5STgcbvkMuK2CmBO9RCJBMplkZWXlwHbxeJwrV64wPj7elrpJywWp1WqUSiXW19dJp9NkMhlSqRRLS0v7tuvp6SEcDjM+Ps7o6CgdHR2tNhVokyALCwvWiGJO6hql6bvp6enh+PHjTExMEI1GWzqh203LBdnc3OTBgwcsLi6SSCTQNA1FUdja2toTSM0YY2azU1NTxONxhoaGkGUZj6c99fCWC1KtVpmfnyeZTJJOp196nn2UGR4e5sKFC/T19bW1lNj0ipkdj8dDX18fkUjE+q1cLjc81/QOIQSappHJZMhms+RyOba2tqjValZiJoT4rV7TsGLWckEkSWJgYICuri7W1tbQNI3l5eU9D2//WwjBysoK3333HU+fPiWVSqGqKoZhEAqF8Pv9zVi+aG8J0WR3zMjn86yurrK8vEw+nyeTyZBOp/n2228pl8tUKpXnRu0SJhwO09nZyfDwMP39/cRiMYaGhpiZmbGC7SsK40yBSJIkJEmyliUUReHcuXPk83kWFhZ48OAB6+vraJrGs2fPrFhiBtlyuUy5XObHH38EYH5+nuHhYd555x0ikYh1/WbRtmhldguv14vH42FwcJDu7m5OnDjB+++/T7lcZn19ndu3b3Pz5k0URWlY/ygUCtRqNVKpFIODgwwODjZ1SG57gch8o7IsEwwG6enp4dixYyiKws7ODsvLy9y+fduaBNp59uyZtUxaqVQ4evRoU210bPpvIkkSQghrfpNOp1FVdc968G58Ph+BQIBwOEwwGGx6fuK4IOZKXrVaJZFIsLq6ao0ojTBX/Do7O/H7/XvKks3AcUEURUFVVWZnZ7lx4wbZbPaltVMhBG+++Sbj4+OcOnWKgYGBpqf0jgiyeyRRVZVarcbS0hJzc3MA+771aDTK0NAQvb29BAKBptvW9npIvV6nWq1SrVapVCokEgkePnzIV199tW97WZbx+/1MT09z+fJlent7W2Jn2wTZvZGmVCqxtrZGNpvl66+/5t69e/vWRoQQdHR0EAwGGR0d5dixYwcuW7wqLRfE9IxSqcQ333zD7Ows9+/ft8oAxWKRtbU16vV6w/bmUubMzAynT5/m4sWLLYkdJm3xEMMw2Nzc5PHjxzx69Ii7d+82PGc3sizj9XqJRCL09vYyMTFBPB4nEom0tFjUckHM/R7FYpHHjx+ztLSELMvWfhA7ZpX9gw8+YHJykvPnz3P8+HH6+/sJBoMtX9BqW5cxP36/n3A4bG2DMPMQ81xza9Xo6Chnz55lcnKSo0eP/pZJ3K+iLdshdF2nXq+zsbFBNptldnaWVCrF999/z5EjR6zFa8MwiEajRKNRJicniUaj+Hw+ZFneUyZoEs5th5AkyQqOfr8fTdMIBoNomsYbb7zByMiIFUOGhobo6+sjGo22fA2mob2t9hA7qqqiKAqaprGzs/Oz6bskSVYcaXEXaeghbRfkEOH+R9UvwRXEhiuIDVcQGwcNu82tvvwP4HqIDVcQG64gNlxBbLiC2HAFsfFfgRz5NXUL1A4AAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that it's a <a href="https://docs.fast.ai/vision.core#PILImage"><code>PILImage</code></a> of a three, along with a label of <code>3</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we need to give ourselves some transforms on the data! These will need to:</p>
<ol>
<li>Ensure our images are all the same size</li>
<li>Make sure our output are the <a href="https://docs.fast.ai/torch_core#tensor"><code>tensor</code></a> our models are wanting</li>
<li>Give some image augmentation</li>
</ol>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">CropPad</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">34</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="n">PadMode</span><span class="o">.</span><span class="n">Zeros</span><span class="p">),</span> <span class="n">RandomCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">28</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="https://docs.fast.ai/data.transforms#ToTensor"><code>ToTensor</code></a>: Converts to tensor</li>
<li><a href="https://docs.fast.ai/vision.augment#CropPad"><code>CropPad</code></a> and <a href="https://docs.fast.ai/vision.augment#RandomCrop"><code>RandomCrop</code></a>: Resizing transforms</li>
<li>Applied on the <code>CPU</code> via <code>after_item</code></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gpu_tfms</span> <span class="o">=</span> <span class="p">[</span><span class="n">IntToFloatTensor</span><span class="p">(),</span> <span class="n">Normalize</span><span class="p">()]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="https://docs.fast.ai/data.transforms#IntToFloatTensor"><code>IntToFloatTensor</code></a>: Converts to a float</li>
<li><a href="https://docs.fast.ai/data.transforms#Normalize"><code>Normalize</code></a>: Normalizes data</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">dsrc</span><span class="o">.</span><span class="n">dataloaders</span><span class="p">(</span><span class="n">bs</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">after_item</span><span class="o">=</span><span class="n">tfms</span><span class="p">,</span> <span class="n">after_batch</span><span class="o">=</span><span class="n">gpu_tfms</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And show a batch</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">show_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From here we need to see what our model will expect</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now the shapes:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((128, 1, 28, 28), (128,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span><span class="o">.</span><span class="n">c</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So our input shape will be a [128 x 1 x 28 x 28] and our output shape will be a [128] tensor that we need to condense into 10 classes</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Model">The Model<a class="anchor-link" href="#The-Model"> </a></h2><p>Our models are made up of <strong>layers</strong>, and each layer represents a matrix multiplication to end up with our final <code>y</code>. For this image problem, we will use a <strong>Convolutional layer</strong>, a <strong>Batch Normalization layer</strong>, an <strong>Activation Function</strong>, and a <strong>Flattening layer</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Convolutional-Layer">Convolutional Layer<a class="anchor-link" href="#Convolutional-Layer"> </a></h3><p>These are always the first layer in our network. I will be borrowing an analogy from <a href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/">here</a> by Adit Deshpande.</p>
<p>Our example Convolutional layer will be 5x5x1</p>
<p>Imagine a flashlight that is shining over the top left of an image, which covers a 5x5 section of pixels at one given moment. This flashlight then slides crosses our pixels at all areas in the picture. This flashlight is called a <strong>filter</strong>, which can also be called a <strong>neuron</strong> or <strong>kernel</strong>. The region it is currently looking over is called a <strong>receptive field</strong>. This filter is also an array of numbers called <strong>weights</strong> (or <strong>parameters</strong>). The depth of this filter <strong>must</strong> be the same as the depth of our input. In our case it is 1 (in a color image this is 3). Now once this filter begins moving (or <strong>convolving</strong>) around the image, it is multiplying the values inside this filter with the original pixel value of our image (also called <strong>element wise multiplications</strong>). These are then summed up (in our case this is just one multiplication of 28x28) to an individual value, which is a representation of <strong>just</strong> the top left of our image. Now repeat this until every unique location has a number and we will get what is called an <strong>activation</strong> or <strong>feature map</strong>. This feature map will be 784 different locations, which turns into a 28x28 array</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">conv</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we can see our <code>ni</code> is equivalent to the depth of the filter, and <code>nf</code> is equivalent to how many filters we will be using. (Fun fact this always has to be divisible by the size of our image).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Batch-Normalization">Batch Normalization<a class="anchor-link" href="#Batch-Normalization"> </a></h3><p>As we send our tensors through our model, it is important to normalize our data throughout the network. Doing so can allow for a much larger improvement in training speed, along with allowing each layer to learn independantly (as each layer is then re-normalized according to it's outputs)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bn</span><span class="p">(</span><span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm2d</span><span class="p">(</span><span class="n">nf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>nf</code> will be the same as the filter output from our previous convolutional layer</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Activation-functions">Activation functions<a class="anchor-link" href="#Activation-functions"> </a></h3><p>They give our models non-linearity and work with the <code>weights</code> we mentioned earlier along with a <code>bias</code> through a process called <strong>back-propagation</strong>. These allow our models to learn and perform more complex tasks because they can choose to fire or activate one of those neurons mentioned earlier. On a simple sense, let's look at the <code>ReLU</code> activation function. It operates by turning any negative values to zero, as visualized below:</p>
<p><img src="https://miro.medium.com/max/2052/1*DfMRHwxY1gyyDmrIAd-gjQ.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From "A Practical Guide to ReLU by Danqing Liu <a href="https://medium.com/@danqing/a-practical-guide-to-relu-b83ca804f1f7">URL</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">ReLU</span><span class="p">():</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Flattening">Flattening<a class="anchor-link" href="#Flattening"> </a></h3><p>The last bit we need to do is take all these activations and this outcoming matrix and flatten it into a single dimention of predictions. We do this with a <code>Flatten()</code> module</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>Flatten<span class="o">??</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Making-a-Model">Making a Model<a class="anchor-link" href="#Making-a-Model"> </a></h2><ul>
<li>Five convolutional layers</li>
<li><code>nn.Sequential</code></li>
<li>1 -&gt; 32 -&gt; 10</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">conv</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
    <span class="n">bn</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now let's make our <a href="https://docs.fast.ai/learner#Learner"><code>Learner</code></a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then also call <code>learn.summary</code> to take a look at all the sizes with thier <strong>exact</strong> output shapes</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential (Input shape: 128)
============================================================================
Layer (type)         Output Shape         Param #    Trainable 
============================================================================
                     128 x 8 x 14 x 14   
Conv2d                                    80         True      
BatchNorm2d                               16         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 16 x 7 x 7    
Conv2d                                    1168       True      
BatchNorm2d                               32         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 32 x 4 x 4    
Conv2d                                    4640       True      
BatchNorm2d                               64         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 16 x 2 x 2    
Conv2d                                    4624       True      
BatchNorm2d                               32         True      
ReLU                                                           
____________________________________________________________________________
                     128 x 10 x 1 x 1    
Conv2d                                    1450       True      
BatchNorm2d                               20         True      
____________________________________________________________________________
                     []                  
Flatten                                                        
____________________________________________________________________________

Total params: 12,126
Total trainable params: 12,126
Total non-trainable params: 0

Optimizer used: &lt;function Adam at 0x7f280c3f3ea0&gt;
Loss function: FlattenedLoss of CrossEntropyLoss()

Callbacks:
  - TrainEvalCallback
  - Recorder
  - ProgressCallback</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>learn.summary</code> also tells us:</p>
<ul>
<li>Total parameters</li>
<li>Trainable parameters</li>
<li>Optimizer</li>
<li>Loss function</li>
<li>Applied <code>Callbacks</code></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(lr_min=0.33113112449646, lr_steep=0.3019951581954956)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's use a learning rate around 1e-1 (0.1)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.221976</td>
      <td>0.197778</td>
      <td>0.935200</td>
      <td>01:32</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.121564</td>
      <td>0.066874</td>
      <td>0.979900</td>
      <td>01:33</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.068036</td>
      <td>0.039550</td>
      <td>0.987700</td>
      <td>01:32</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Simplify-it">Simplify it<a class="anchor-link" href="#Simplify-it"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Try to make it more like <code>ResNet</code>.</li>
<li><a href="https://docs.fast.ai/layers#ConvLayer"><code>ConvLayer</code></a> contains a <code>Conv2d</code>, <code>BatchNorm2d</code>, and an activation function</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">conv2</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">ConvLayer</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And make a new model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Great! That looks much better to read! Let's make sure we get (roughly) the same results with it.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">net</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.220734</td>
      <td>0.197168</td>
      <td>0.933900</td>
      <td>01:15</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.130333</td>
      <td>0.075714</td>
      <td>0.975800</td>
      <td>01:14</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.078764</td>
      <td>0.041104</td>
      <td>0.987000</td>
      <td>01:15</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Almost the exact same! Perfect! Now let's get a bit more advanced</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="ResNet-(kinda)">ResNet (kinda)<a class="anchor-link" href="#ResNet-(kinda)"> </a></h2><p>The ResNet architecture is built with what are known as ResBlocks. Each of these blocks consist of two <code>ConvLayers</code> that we made before, where the number of filters do not change. Let's generate these layers.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ResBlock</span><span class="p">(</span><span class="n">Module</span><span class="p">):</span>
  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">ConvLayer</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">ConvLayer</span><span class="p">(</span><span class="n">nf</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Class notation</li>
<li><code>__init__</code></li>
<li><code>foward</code></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's add these in between each of our <code>conv2</code> layers of that last model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">ResBlock</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Sequential(
  (0): ConvLayer(
    (0): Conv2d(1, 8, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (1): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (1): ResBlock(
    (conv1): ConvLayer(
      (0): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (conv2): ConvLayer(
      (0): Conv2d(8, 8, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(8, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
  )
  (2): ConvLayer(
    (0): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (3): ResBlock(
    (conv1): ConvLayer(
      (0): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (conv2): ConvLayer(
      (0): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
  )
  (4): ConvLayer(
    (0): Conv2d(16, 32, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (5): ResBlock(
    (conv1): ConvLayer(
      (0): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (conv2): ConvLayer(
      (0): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
  )
  (6): ConvLayer(
    (0): Conv2d(32, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (7): ResBlock(
    (conv1): ConvLayer(
      (0): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
    (conv2): ConvLayer(
      (0): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU()
    )
  )
  (8): ConvLayer(
    (0): Conv2d(16, 10, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
    (1): BatchNorm2d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
  )
  (9): Flatten()
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Awesome! We're building a pretty substantial model here. Let's try to make it <strong>even simpler</strong>. We know we call a convolutional layer before each <a href="https://docs.fast.ai/layers#ResBlock"><code>ResBlock</code></a> and they all have the same filters, so let's make that layer!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">conv_and_res</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">):</span> <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">conv2</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">),</span> <span class="n">ResBlock</span><span class="p">(</span><span class="n">nf</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span>
    <span class="n">conv_and_res</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">conv2</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">Flatten</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we have something that resembles a ResNet! Let's see how it performs</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">net</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">CrossEntropyLossFlat</span><span class="p">(),</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
rkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's do 1e-1 again</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr_max</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.156825</td>
      <td>0.904546</td>
      <td>0.756200</td>
      <td>01:16</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.089813</td>
      <td>0.063087</td>
      <td>0.980300</td>
      <td>01:16</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.040906</td>
      <td>0.025675</td>
      <td>0.992200</td>
      <td>01:18</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

